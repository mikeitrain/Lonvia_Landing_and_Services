(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[11],{6006:(e,i,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/doctor/profile",function(){return t(6199)}])},815:(e,i,t)=>{"use strict";t.d(i,{D:()=>c});var l=t(4848),s=t(6540),r=t(6715),a=t(98),o=t(548),n=t(5182);let c=e=>{let{children:i}=e,t=(0,r.useRouter)(),{t:c}=(0,a.o)(),[d,u]=(0,s.useState)(!0);return(0,s.useEffect)(()=>{(async()=>{try{var e,i;let l=await (0,o.$)(),s=null===(i=l.tokens)||void 0===i?void 0:null===(e=i.idToken)||void 0===e?void 0:e.payload;if(!((null==s?void 0:s["cognito:groups"])||[]).includes("doctor")){t.replace("/user/profile");return}}finally{u(!1)}})()},[t]),(0,l.jsx)(n.O,{children:d?(0,l.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background-secondary",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),(0,l.jsx)("p",{className:"text-body",children:c("common.loading")})]})}):(0,l.jsx)(l.Fragment,{children:i})})}},6199:(e,i,t)=>{"use strict";t.r(i),t.d(i,{default:()=>v});var l=t(4848),s=t(6540),r=t(9970),a=t(98),o=t(6578),n=t(9785),c=t(5287),d=t(9868),u=t(1023),f=t(8657);let p=()=>{let{t:e}=(0,a.o)(),{user:i}=(0,o.A)(),{addNotification:t}=(0,u.E)(),r=s.useMemo(()=>d.k.getInstance(),[]),[p,m]=(0,s.useState)(null),[y,b]=(0,s.useState)([]),[v,x]=(0,s.useState)([]),[N,h]=(0,s.useState)(!1),[j,g]=(0,s.useState)(""),[S,w]=(0,s.useState)(""),{register:E,handleSubmit:I,formState:{errors:A,isValid:D},reset:P,watch:_}=(0,n.mN)({mode:"onChange",defaultValues:{title:"",licenseNumber:"",licenseExpiryDate:"",bio:"",consultationFee:0,lan:"de",firstName:"",lastName:"",specialtyId:0,subspecialtyId:0}}),k=_("specialtyId");(0,s.useEffect)(()=>{(async()=>{x(await r.getAllSpecialties());let e=await r.getDoctorSelf();e&&m(e)})()},[r]),(0,s.useEffect)(()=>{if(p&&v.length>0){var e,i,t;let l=0,s=0,r=[];if(p.specialties&&p.specialties.length>0){let e=p.specialties.find(e=>e.isPrimary);e&&(l=e.specialty.id,s=(null===(t=e.subspecialty)||void 0===t?void 0:t.id)||0,r=p.specialties.filter(e=>!e.isPrimary))}P({title:p.title||"",licenseNumber:p.licenseNumber||"",licenseExpiryDate:p.licenseExpiryDate||"",bio:p.bio||"",consultationFee:p.consultationFee||0,lan:p.lan||"de",firstName:(null===(e=p.user)||void 0===e?void 0:e.firstName)||"",lastName:(null===(i=p.user)||void 0===i?void 0:i.lastName)||"",specialtyId:l,subspecialtyId:s}),b(r)}},[p,P,v]),(0,s.useEffect)(()=>{k&&k>0&&P({..._(),subspecialtyId:0})},[k,P,_]);let C=e=>{if(!e||0===e)return[];let i=v.find(i=>i.id===e);return(null==i?void 0:i.subspecialties)||[]},F=e=>{if(null!=e){if(Array.isArray(e))return e.map(F).filter(e=>void 0!==e);if("object"==typeof e&&null!==e){let i={};for(let[t,l]of Object.entries(e)){let e=F(l);null!=e&&(i[t]=e)}return Object.keys(i).length>0?i:void 0}return e}},O=async e=>{h(!0);try{var l,s;let a=Number(e.specialtyId),o=Number(e.subspecialtyId),n=Number(e.consultationFee)||0,c=[...y||[]];if(a&&a>0){let e=v.find(e=>e.id===a);if(e){let i=o&&o>0?C(a).find(e=>e.id===o):null;c=[{id:0,doctorProfileId:0,specialty:e,subspecialty:i||void 0,isPrimary:!0,createdAt:new Date},...c]}}let d={title:e.title,licenseNumber:e.licenseNumber,licenseExpiryDate:e.licenseExpiryDate,isActive:null===(s=null==p?void 0:p.isActive)||void 0===s||s,bio:e.bio,consultationFee:n,lan:e.lan,userId:(null==p?void 0:p.userId)||(null==i?void 0:i.id)||"",specialties:c,user:{...null==p?void 0:p.user,firstName:e.firstName,lastName:e.lastName,id:(null==p?void 0:null===(l=p.user)||void 0===l?void 0:l.id)||(null==i?void 0:i.id)||""}},u=F(d),f=await r.upsertDoctor(u);m(f),t("success","Profile updated successfully")}finally{h(!1)}};return(0,l.jsx)("div",{className:"p-6",children:(0,l.jsxs)("form",{onSubmit:I(O),className:"space-y-6",children:[(0,l.jsx)(f.A,{register:E,errors:A,watch:_,availableSpecialties:v,specialties:y||[],additionalSpecialtyId:j,additionalSubspecialtyId:S,onAdditionalSpecialtyChange:g,onAdditionalSubspecialtyChange:w,onAddSpecialty:()=>{if(j){let e=v.find(e=>e.id===Number(j));if(e){let i=S?C(Number(j)).find(e=>e.id===Number(S)):null;if(!(null==y?void 0:y.some(e=>{var t;return e.specialty.id===Number(j)&&(null===(t=e.subspecialty)||void 0===t?void 0:t.id)===((null==i?void 0:i.id)||null)}))){let t={id:0,doctorProfileId:0,specialty:e,subspecialty:i||void 0,isPrimary:!1,createdAt:new Date};b(e=>[...e||[],t]),w(""),g("")}}}},onRemoveSpecialty:e=>{b(i=>(i||[]).filter(i=>i.specialty.id!==e))},showEmailField:!1,showIsActiveField:!1}),(0,l.jsx)("div",{className:"flex justify-end space-x-3 pt-6 border-t border-border-primary",children:(0,l.jsx)(c.$,{type:"submit",disabled:N||!D||!k||0===k,children:e(N?"common.working":"doctor.details.save")})})]})})},m=e=>{let{initialSection:i="doctor-details"}=e,{t}=(0,a.o)(),{userGroups:n}=(0,o.A)(),c=(0,s.useMemo)(()=>n.includes("doctor"),[n]),d=(0,s.useMemo)(()=>[{id:"doctor-details",label:t("doctor.profile.title")||"Doctor Profile"},{id:"security",label:t("profile.security")||"Security Settings"},{id:"preferences",label:t("profile.preferences")||"Preferences"},{id:"notifications",label:t("profile.notifications")||"Notifications"}],[t]),[u,f]=(0,s.useState)(i);return((0,s.useEffect)(()=>{i&&["doctor-details","security","preferences","notifications"].includes(i)&&f(i)},[i]),c)?(0,l.jsx)(r.A,{title:t("doctor.profile.title")||"Doctor Profile",subtitle:t("doctor.profile.subtitle")||"Manage your professional profile",menuItems:d,activeSection:u,onSectionChange:f,children:(()=>{switch(u){case"doctor-details":return(0,l.jsx)(p,{},"doctor-details");case"security":return(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4 text-foreground-primary",children:t("profile.security")||"Security Settings"}),(0,l.jsx)("div",{className:"text-center py-8",children:(0,l.jsx)("p",{className:"text-foreground-secondary",children:t("profile.securityComingSoon")||"Security settings will be available soon"})})]});case"preferences":return(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4 text-foreground-primary",children:t("profile.preferences")||"Preferences"}),(0,l.jsx)("div",{className:"text-center py-8",children:(0,l.jsx)("p",{className:"text-foreground-secondary",children:t("profile.preferencesComingSoon")||"Preferences will be available soon"})})]});case"notifications":return(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4 text-foreground-primary",children:t("profile.notifications")||"Notifications"}),(0,l.jsx)("div",{className:"text-center py-8",children:(0,l.jsx)("p",{className:"text-foreground-secondary",children:t("profile.notificationsComingSoon")||"Notification settings will be available soon"})})]});default:return(0,l.jsx)(p,{},"doctor-details-default")}})()}):(0,l.jsx)("div",{className:"p-6",children:(0,l.jsx)("p",{className:"text-foreground-secondary",children:"Access denied. Doctor profile access required."})})};var y=t(815),b=t(6715);function v(){let{section:e}=(0,b.useRouter)().query;return(0,s.useEffect)(()=>{},[e]),(0,l.jsx)(y.D,{children:(0,l.jsx)(m,{initialSection:e})})}}},e=>{var i=i=>e(e.s=i);e.O(0,[785,403,636,593,792],()=>i(6006)),_N_E=e.O()}]);
//# sourceMappingURL=profile-6f7959aa53cbf925.js.map